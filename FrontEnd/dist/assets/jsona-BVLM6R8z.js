import{g as T}from"./@popperjs-B6MXTrwr.js";import{r as j}from"./tslib-C-Z3qzqh.js";var z={},C={},h={};Object.defineProperty(h,"__esModule",{value:!0});h.isPlainObject=h.jsonParse=h.createIncludeNamesTree=void 0;function g(s,e){var t=s.split("."),r=t.shift(),i=t.length,n=null;i&&(n=e[r]||{},g(t.join("."),n)),e[r]=n}h.createIncludeNamesTree=g;function J(s){var e;try{e=JSON.parse(s)}catch(t){e={},console.warn(t)}return e}h.jsonParse=J;var N=function(s){return!!s&&typeof s=="object"&&s.constructor===Object};h.isPlainObject=N;var v={};Object.defineProperty(v,"__esModule",{value:!0});v.ModelsSerializer=void 0;var O=j,B=h,m=function(){function s(e){e&&this.setPropertiesMapper(e),this.buildIncludedIndex=0}return s.prototype.setPropertiesMapper=function(e){this.propertiesMapper=e},s.prototype.setStuff=function(e){this.stuff=e},s.prototype.setIncludeNames=function(e){if(Array.isArray(e)){var t={};e.forEach(function(r){(0,B.createIncludeNamesTree)(r,t)}),this.includeNamesTree=t}else this.includeNamesTree=e},s.prototype.build=function(){var e=this,t=e.stuff,r=e.propertiesMapper;if(!r||typeof r!="object")throw new Error("ModelsSerializer cannot build, propertiesMapper is not set");if(!t||typeof t!="object")throw new Error("ModelsSerializer cannot build, stuff is not set");var i={},n={};if(t&&Array.isArray(t)){for(var a=t.length,o=[],p=0;p<a;p++)o.push(this.buildDataByModel(t[p])),this.buildIncludedByModel(t[p],this.includeNamesTree,n);i.data=o}else t?(i.data=this.buildDataByModel(t),this.buildIncludedByModel(t,this.includeNamesTree,n)):t===null&&(i.data=null);return Object.keys(n).length&&(i.included=Object.values(n)),i},s.prototype.buildDataByModel=function(e){var t=this.propertiesMapper.getId(e),r=this.propertiesMapper.getType(e),i=this.propertiesMapper.getAttributes(e),n=O.__assign(O.__assign({type:r},typeof t<"u"?{id:t}:{}),typeof i<"u"?{attributes:i}:{});if(typeof n.type!="string"||!n.type)throw console.warn("ModelsSerializer cannot buildDataByModel, type is not set or incorrect",e),new Error("ModelsSerializer cannot buildDataByModel, type is not set or incorrect");var a=this.buildRelationshipsByModel(e);return a&&Object.keys(a).length&&(n.relationships=a),n},s.prototype.buildResourceObjectPart=function(e){var t=this.propertiesMapper.getId(e),r=this.propertiesMapper.getType(e);return O.__assign({type:r},typeof t>"u"?{}:{id:t})},s.prototype.buildRelationshipsByModel=function(e){var t=this,r=this.propertiesMapper.getRelationships(e);if(!(!r||!Object.keys(r).length)){var i={};return Object.keys(r).forEach(function(n){var a=r[n];if(Array.isArray(a)){for(var o=[],p=0,l=a;p<l.length;p++){var c=l[p],u=t.buildResourceObjectPart(c);"type"in u?o.push(u):console.error("Can't create data item for relationship ".concat(n,`,
                            it doesn't have 'id' or 'type', it was skipped`),c)}i[n]={data:o}}else if(a){var d=t.buildResourceObjectPart(a);"type"in d?i[n]={data:d}:console.error("Can't create data for relationship ".concat(n,", it doesn't have 'type', it was skipped"),a)}else i[n]={data:a}}),i}},s.prototype.buildIncludedByModel=function(e,t,r){if(r===void 0&&(r={}),!(!t||!Object.keys(t).length)){var i=this.propertiesMapper.getRelationships(e);if(!(!i||!Object.keys(i).length))for(var n=Object.keys(t),a=n.length,o=0;o<a;o++){var p=n[o],l=i[p];if(l)if(Array.isArray(l))for(var c=l.length,u=0;u<c;u++){var d=l[u];this.buildIncludedItem(d,t[p],r)}else this.buildIncludedItem(l,t[p],r)}}},s.prototype.buildIncludedItem=function(e,t,r){var i=this.propertiesMapper.getId(e),n=this.propertiesMapper.getType(e),a=n+i;(!i||!r[a])&&(a in r&&(a+=this.buildIncludedIndex,this.buildIncludedIndex+=1),r[a]=this.buildDataByModel(e),t&&this.buildIncludedByModel(e,t,r))},s}();v.ModelsSerializer=m;v.default=m;var M={};Object.defineProperty(M,"__esModule",{value:!0});M.JsonDeserializer=void 0;var w=function(){function s(e,t,r){this.preferNestedDataFromData=!1,this.setPropertiesMapper(e),this.setDeserializeCache(t),r&&r.preferNestedDataFromData&&(this.preferNestedDataFromData=!0)}return s.prototype.setDeserializeCache=function(e){this.dc=e},s.prototype.setPropertiesMapper=function(e){this.pm=e},s.prototype.setJsonParsedObject=function(e){this.body=e},s.prototype.build=function(){var e=this.body.data,t;if(Array.isArray(e)){t=[];for(var r=e.length,i=0;i<r;i++)if(e[i]){var n=this.buildModelByData(e[i]);n&&t.push(n)}}else e&&(t=this.buildModelByData(e));return t},s.prototype.buildModelByData=function(e,t){var r=this.dc.getCachedModel(e,t);if(r)return r;var i=this.pm.createModel(e.type);if(this.dc.handleModel(i,e,t),i){this.pm.setId(i,e.id),e.attributes&&this.pm.setAttributes(i,e.attributes),e.meta&&this.pm.setMeta&&this.pm.setMeta(i,e.meta),e.links&&this.pm.setLinks&&this.pm.setLinks(i,e.links),t!=null&&t.meta&&this.pm.setResourceIdObjMeta(i,t.meta);var n=this.buildRelationsByData(e,i);n&&this.pm.setRelationships(i,n)}return i},s.prototype.buildRelationsByData=function(e,t){var r={};if(e.relationships)for(var i in e.relationships){var n=e.relationships[i];if(Array.isArray(n.data)){r[i]=[];for(var a=n.data.length,o=void 0,p=0;p<a;p++)if(o=n.data[p],!!o){var l=this.buildDataFromIncludedOrData(o.id,o.type);r[i].push(this.buildModelByData(l,o))}}else if(n.data){var l=this.buildDataFromIncludedOrData(n.data.id,n.data.type);r[i]=this.buildModelByData(l,n.data)}else n.data===null&&(r[i]=null);if(n.links){var c=this.pm.setRelationshipLinks;c&&c(t,i,n.links)}if(n.meta){var u=this.pm.setRelationshipMeta;u&&u(t,i,n.meta)}}return Object.keys(r).length?r:null},s.prototype.buildDataFromIncludedOrData=function(e,t){if(this.preferNestedDataFromData){var r=this.buildDataInObject(),i=r[t+e];if(i)return i}var n=this.buildIncludedInObject(),a=n[t+e];if(a)return a;if(!this.preferNestedDataFromData){var r=this.buildDataInObject(),i=r[t+e];if(i)return i}return{id:e,type:t}},s.prototype.buildDataInObject=function(){if(!this.dataInObject){this.dataInObject={};var e=this.body.data,t=e.length;if(e&&t)for(var r=0;r<t;r++){var i=e[r];this.dataInObject[i.type+i.id]=i}else e&&(this.dataInObject[e.type+e.id]=e)}return this.dataInObject},s.prototype.buildIncludedInObject=function(){if(!this.includedInObject&&(this.includedInObject={},this.body.included))for(var e=this.body.included.length,t=0;t<e;t++){var r=this.body.included[t];this.includedInObject[r.type+r.id]=r}return this.includedInObject},s}();M.JsonDeserializer=w;M.default=w;var A={};Object.defineProperty(A,"__esModule",{value:!0});var L=function(){function s(e){this.cachedModels={},this.setPropertiesMapper(e)}return s.prototype.setPropertiesMapper=function(e){this.propertiesMapper=e},s.prototype.setReduxObject=function(e){this.reduxObject=e},s.prototype.setEntityType=function(e){this.entityType=e},s.prototype.setEntityIds=function(e){this.ids=e},s.prototype.setReturnBuilderInRelations=function(e){this.returnBuilderInRelations=e},s.prototype.build=function(){var e=this,t=this,r=t.reduxObject,i=t.entityType,n=t.propertiesMapper;if(!n||typeof n!="object")throw new Error("ReduxObjectDenormalizer cannot build, propertiesMapper is not set");if(!r||typeof r!="object")throw new Error("ReduxObjectDenormalizer cannot build, reduxObject is not set");if(!i)throw new Error("ReduxObjectDenormalizer cannot build, entityType is not set");if(!r[i])return null;var a=this.ids;if(a||(a=Object.keys(r[i])),Array.isArray(a)){if(!a.length)return null;var o=[];return a.forEach(function(p){var l=e.buildModel(i,p);l&&o.push(l)}),o}return this.buildModel(i,a)},s.prototype.buildModel=function(e,t){var r=this.reduxObject;if(!r[e])return null;var i=r[e][t];if(!i)return null;var n="".concat(e,"-").concat(t),a=this.cachedModels[n];if(!a&&(a=this.propertiesMapper.createModel(e),a)){this.cachedModels[n]=a,this.propertiesMapper.setId(a,i.id),i.attributes&&this.propertiesMapper.setAttributes(a,i.attributes);var o=this.buildRelationships(a,i.relationships);o&&this.propertiesMapper.setRelationships(a,o)}return a},s.prototype.buildRelationships=function(e,t){var r=this;if(!t)return null;var i=Object.keys(t);if(!i.length)return null;var n={};return i.forEach(function(a){var o=t[a];if(o&&o.data&&(r.returnBuilderInRelations?n[a]=r.buildRelationModels.bind(r,o.data):n[a]=r.buildRelationModels(o.data)),o&&o.links&&r.propertiesMapper.setRelationshipLinks(e,a,o.links),o&&o.meta){var p=r.propertiesMapper.setRelationshipMeta;p&&p(e,a,o.meta)}}),Object.keys(n).length?n:null},s.prototype.buildRelationModels=function(e){var t=this;if(Array.isArray(e)){var r=[];return e.forEach(function(i){var n=t.buildModel(i.type,i.id);r.push(n||i)}),r}else if(e.id&&e.type)return this.buildModel(e.type,e.id)||e;return null},s}();A.default=L;var P={};(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.JsonPropertiesMapper=s.defineRelationGetter=s.ModelPropertiesMapper=s.RELATIONSHIP_NAMES_PROP=void 0;var e=j;s.RELATIONSHIP_NAMES_PROP="relationshipNames";var t=function(){function n(){}return n.prototype.getId=function(a){return a.id},n.prototype.getType=function(a){return a.type},n.prototype.getAttributes=function(a){var o=["id","type",s.RELATIONSHIP_NAMES_PROP];Array.isArray(a[s.RELATIONSHIP_NAMES_PROP])?o.push.apply(o,a[s.RELATIONSHIP_NAMES_PROP]):a[s.RELATIONSHIP_NAMES_PROP]&&console.warn("Can't getAttributes correctly, '".concat(s.RELATIONSHIP_NAMES_PROP,"' property of ").concat(a.type,"-").concat(a.id,` model
                isn't array of relationship names`),a[s.RELATIONSHIP_NAMES_PROP]);var p={};return Object.keys(a).forEach(function(l){o.indexOf(l)===-1&&(p[l]=a[l])}),p},n.prototype.getRelationships=function(a){var o=a[s.RELATIONSHIP_NAMES_PROP];if(!(!o||Array.isArray(o)&&!o.length)){if(o&&!Array.isArray(o)){console.warn(`Can't getRelationships correctly,
                '`.concat(s.RELATIONSHIP_NAMES_PROP,"' property of ").concat(a.type,"-").concat(a.id,` model
                isn't array of relationship names`),a[s.RELATIONSHIP_NAMES_PROP]);return}var p={};return o.forEach(function(l){a[l]!==void 0&&(p[l]=a[l])}),p}},n}();s.ModelPropertiesMapper=t;function r(n,a,o){Object.defineProperty(n,a,{enumerable:!0,configurable:!0,set:function(p){delete n[a],n[a]=p},get:function(){return delete n[a],n[a]=o()}})}s.defineRelationGetter=r;var i=function(){function n(){}return n.prototype.createModel=function(a){return{type:a}},n.prototype.setId=function(a,o){a.id=o},n.prototype.setAttributes=function(a,o){Object.keys(o).forEach(function(p){a[p]=o[p]})},n.prototype.setMeta=function(a,o){a.meta=o},n.prototype.setLinks=function(a,o){a.links=o},n.prototype.setResourceIdObjMeta=function(a,o){a.resourceIdObjMeta=o},n.prototype.setRelationships=function(a,o){Object.keys(o).forEach(function(c){typeof o[c]=="function"?r(a,c,o[c]):a[c]=o[c]});var p=Object.keys(o),l=a[s.RELATIONSHIP_NAMES_PROP];l&&l.length?a[s.RELATIONSHIP_NAMES_PROP]=e.__spreadArray(e.__spreadArray([],l,!0),p,!0).filter(function(c,u,d){return d.indexOf(c)===u}):a[s.RELATIONSHIP_NAMES_PROP]=p},n.prototype.setRelationshipLinks=function(a,o,p){},n.prototype.setRelationshipMeta=function(a,o,p){},n}();s.JsonPropertiesMapper=i})(P);var f={};Object.defineProperty(f,"__esModule",{value:!0});f.DeserializeCache=f.jsonStringify=void 0;function R(s){var e;try{e=JSON.stringify(s)}catch(t){e="",console.warn(t)}return e}f.jsonStringify=R;var k=function(){function s(){this.cachedModels={}}return s.prototype.getCachedModel=function(e,t){var r=this.createCacheKey(e,t);return this.cachedModels[r]||null},s.prototype.handleModel=function(e,t,r){var i=this.createCacheKey(t,r),n=t.attributes||t.relationships;i&&n&&(this.cachedModels[i]=e)},s.prototype.createCacheKey=function(e,t){if(!(!e.id||!e.type)){var r=t?"".concat(t.type,"-").concat(t.id):"";return t!=null&&t.meta&&(r+="-".concat(R(t.meta))),e.meta?"".concat(e.type,"-").concat(e.id,"-").concat(R(e.meta),"-").concat(r):"".concat(e.type,"-").concat(e.id,"-").concat(r)}},s}();f.DeserializeCache=k;Object.defineProperty(C,"__esModule",{value:!0});var F=h,H=v,$=M,K=A,S=P,G=f,q=function(){function s(e){this.modelPropertiesMapper=new S.ModelPropertiesMapper,this.jsonPropertiesMapper=new S.JsonPropertiesMapper,this.DeserializeCache=G.DeserializeCache,this.ModelsSerializer=H.default,this.JsonDeserializer=$.default,e&&e.modelPropertiesMapper&&(this.modelPropertiesMapper=e.modelPropertiesMapper),e&&e.jsonPropertiesMapper&&(this.jsonPropertiesMapper=e.jsonPropertiesMapper),e&&e.DeserializeCache&&(this.DeserializeCache=e.DeserializeCache),e&&e.ModelsSerializer&&(this.ModelsSerializer=e.ModelsSerializer),e&&e.JsonDeserializer&&(this.JsonDeserializer=e.JsonDeserializer)}return s.prototype.serialize=function(e){var t=e.stuff,r=e.includeNames;if(!t)throw new Error("Jsona can not serialize, stuff is not passed");var i=new this.ModelsSerializer(this.modelPropertiesMapper);return i.setStuff(t),r&&i.setIncludeNames(r),i.build()},s.prototype.deserialize=function(e,t){if(!e)throw new Error("Jsona can not deserialize, body is not passed");var r=new this.DeserializeCache,i=new this.JsonDeserializer(this.jsonPropertiesMapper,r,t);return typeof e=="string"?i.setJsonParsedObject((0,F.jsonParse)(e)):i.setJsonParsedObject(e),i.build()},s.prototype.denormalizeReduxObject=function(e){var t=e.reduxObject,r=e.entityType,i=e.entityIds,n=e.returnBuilderInRelations,a=n===void 0?!1:n;if(!t)throw new Error("Jsona can not denormalize ReduxObject, incorrect reduxObject passed");if(!r)throw new Error("Jsona can not denormalize ReduxObject, entityType is not passed");if(!t[r])return null;var o=new K.default(this.jsonPropertiesMapper);return o.setReduxObject(t),o.setEntityType(r),o.setReturnBuilderInRelations(a),i&&o.setEntityIds(Array.isArray(i)?i:i.toString()),o.build()},s}();C.default=q;var y={};Object.defineProperty(y,"__esModule",{value:!0});y.SwitchCaseJsonMapper=y.SwitchCaseModelMapper=void 0;var I=j,b=P,D=h,x=function(s){I.__extends(e,s);function e(t){var r=s.call(this)||this,i=t||{},n=i.switchAttributes,a=n===void 0?!0:n,o=i.switchRelationships,p=o===void 0?!0:o,l=i.switchType,c=l===void 0?!0:l,u=i.switchChar,d=u===void 0?"-":u;return r.switchAttributes=a,r.switchRelationships=p,r.switchType=c,r.switchChar=d,r.regex=new RegExp(/([a-z][A-Z0-9])/g),r}return e.prototype.getType=function(t){var r=s.prototype.getType.call(this,t);return!this.switchType||!r?r:this.convertFromCamelCaseString(r)},e.prototype.getAttributes=function(t){var r=s.prototype.getAttributes.call(this,t);return!this.switchAttributes||!r?r:this.convertFromCamelCase(r)},e.prototype.getRelationships=function(t){var r=s.prototype.getRelationships.call(this,t);return!this.switchRelationships||!r?r:this.convertFromCamelCase(r)},e.prototype.convertFromCamelCase=function(t){var r=this;if(Array.isArray(t))return t.map(function(n){return r.convertFromCamelCase(n)});if((0,D.isPlainObject)(t)){var i={};return Object.entries(t).forEach(function(n){var a=n[0],o=n[1],p=r.convertFromCamelCaseString(a);i[p]=r.convertFromCamelCase(o)}),i}return t},e.prototype.convertFromCamelCaseString=function(t){var r=this;return t.replace(this.regex,function(i){return i[0]+r.switchChar+i[1].toLowerCase()})},e}(b.ModelPropertiesMapper);y.SwitchCaseModelMapper=x;var U=function(s){I.__extends(e,s);function e(t){var r=s.call(this)||this,i=t||{},n=i.camelizeAttributes,a=n===void 0?!0:n,o=i.camelizeRelationships,p=o===void 0?!0:o,l=i.camelizeType,c=l===void 0?!0:l,u=i.camelizeMeta,d=u===void 0?!1:u,_=i.switchChar,E=_===void 0?"-":_;return r.camelizeAttributes=a,r.camelizeRelationships=p,r.camelizeType=c,r.camelizeMeta=d,r.switchChar=E,r.regex=new RegExp("".concat(r.switchChar,"([a-z0-9])"),"g"),r}return e.prototype.createModel=function(t){if(!this.camelizeType)return{type:t};var r=this.convertToCamelCaseString(t);return{type:r}},e.prototype.setAttributes=function(t,r){if(!this.camelizeAttributes)return s.prototype.setAttributes.call(this,t,r);Object.assign(t,this.convertToCamelCase(r))},e.prototype.setMeta=function(t,r){if(!this.camelizeMeta)return s.prototype.setMeta.call(this,t,r);t.meta=this.convertToCamelCase(r)},e.prototype.setRelationships=function(t,r){var i=this;s.prototype.setRelationships.call(this,t,r),this.camelizeRelationships&&t[b.RELATIONSHIP_NAMES_PROP].forEach(function(n,a){var o=i.convertToCamelCaseString(n);o!==n&&(t[o]=t[n],delete t[n],t[b.RELATIONSHIP_NAMES_PROP][a]=o)})},e.prototype.convertToCamelCase=function(t){var r=this;if(Array.isArray(t))return t.map(function(n){return r.convertToCamelCase(n)});if((0,D.isPlainObject)(t)){var i={};return Object.entries(t).forEach(function(n){var a=n[0],o=n[1],p=r.convertToCamelCaseString(a);i[p]=r.convertToCamelCase(o)}),i}return t},e.prototype.convertToCamelCaseString=function(t){return t.replace(this.regex,function(r){return r[1].toUpperCase()})},e}(b.JsonPropertiesMapper);y.SwitchCaseJsonMapper=U;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SwitchCaseJsonMapper=s.SwitchCaseModelMapper=s.JsonPropertiesMapper=s.ModelPropertiesMapper=s.JsonDeserializer=s.ModelsSerializer=s.Jsona=void 0;var e=C;s.Jsona=e.default;var t=v;s.ModelsSerializer=t.default;var r=M;s.JsonDeserializer=r.default;var i=P;Object.defineProperty(s,"ModelPropertiesMapper",{enumerable:!0,get:function(){return i.ModelPropertiesMapper}}),Object.defineProperty(s,"JsonPropertiesMapper",{enumerable:!0,get:function(){return i.JsonPropertiesMapper}});var n=y;Object.defineProperty(s,"SwitchCaseModelMapper",{enumerable:!0,get:function(){return n.SwitchCaseModelMapper}}),Object.defineProperty(s,"SwitchCaseJsonMapper",{enumerable:!0,get:function(){return n.SwitchCaseJsonMapper}}),s.default=e.default})(z);const Q=T(z);export{Q as J};
